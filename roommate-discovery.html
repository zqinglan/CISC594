<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniRoomie - Find Your Perfect Roommate</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <header class="header">
        <div class="container">
            <div class="logo">
                <i class="fas fa-home"></i>
                <h1>UniRoomie</h1>
            </div>
            <nav class="nav">
                <a href="#" class="active">Discover</a>
                <a href="messaging.html">Messages</a>
                <a href="roomlistings.html">Rooms</a>
                <a href="#">Profile</a>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <section class="filters-section">
                <h2>Find Your Perfect Roommate</h2>
                
                <!-- Search Bar -->
                <div class="search-section">
                    <div class="search-container">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" id="searchInput" placeholder="Search by name, occupation, or university..." class="search-input">
                        <button id="clearSearch" class="clear-search" style="display: none;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                
                <div class="filters">
                    <div class="filter-group">
                        <label for="budget">Budget Range</label>
                        <select id="budget">
                            <option value="">Any Budget</option>
                            <option value="500-800">$500 - $800</option>
                            <option value="800-1200">$800 - $1,200</option>
                            <option value="1200-1500">$1,200 - $1,500</option>
                            <option value="1500+">$1,500+</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="age">Age Range</label>
                        <select id="age">
                            <option value="">Any Age</option>
                            <option value="18-25">18-25</option>
                            <option value="26-35">26-35</option>
                            <option value="36-45">36-45</option>
                            <option value="45+">45+</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="gender">Gender</label>
                        <select id="gender">
                            <option value="">Any Gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="non-binary">Non-binary</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="lifestyle">Lifestyle</label>
                        <select id="lifestyle">
                            <option value="">Any Lifestyle</option>
                            <option value="quiet">Quiet/Studious</option>
                            <option value="social">Social/Outgoing</option>
                            <option value="balanced">Balanced</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="location">Location</label>
                        <select id="location">
                            <option value="">Any Location</option>
                            <option value="downtown">Downtown</option>
                            <option value="suburbs">Suburbs</option>
                            <option value="campus">Near Campus</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="occupation">Occupation</label>
                        <select id="occupation">
                            <option value="">Any Occupation</option>
                            <option value="student">Student</option>
                            <option value="professional">Professional</option>
                            <option value="graduate">Graduate Student</option>
                            <option value="undergraduate">Undergraduate Student</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="university">University</label>
                        <select id="university">
                            <option value="">Any University</option>
                            <option value="State University">State University</option>
                            <option value="Tech Institute">Tech Institute</option>
                            <option value="Medical School">Medical School</option>
                            <option value="Business School">Business School</option>
                            <option value="Design Institute">Design Institute</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="rating">Minimum Rating</label>
                        <select id="rating">
                            <option value="">Any Rating</option>
                            <option value="4.5">4.5+ Stars</option>
                            <option value="4.0">4.0+ Stars</option>
                            <option value="3.5">3.5+ Stars</option>
                            <option value="3.0">3.0+ Stars</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="sort">Sort By</label>
                        <select id="sort">
                            <option value="compatibility">Compatibility Score</option>
                            <option value="budget">Budget (Low to High)</option>
                            <option value="age">Age</option>
                            <option value="name">Name (A-Z)</option>
                            <option value="rating">Rating (High to Low)</option>
                        </select>
                    </div>
                </div>

                <div class="filter-actions">
                    <button id="applyFilters" class="btn-primary">
                        <i class="fas fa-search"></i>
                        Apply Filters
                    </button>
                    <button id="clearFilters" class="btn-secondary">
                        <i class="fas fa-times"></i>
                        Clear All
                    </button>
                </div>
            </section>

            <!-- Results Section -->
            <section class="results-section">
                <div class="results-header">
                    <div class="results-info">
                        <h3>Roommate Profiles</h3>
                        <span id="resultsCount" class="results-count">Showing all profiles</span>
                    </div>
                    <div class="view-toggle">
                        <button id="gridViewBtn" class="view-btn active" title="Grid View">
                            <i class="fas fa-th"></i>
                        </button>
                        <button id="listViewBtn" class="view-btn" title="List View">
                            <i class="fas fa-list"></i>
                        </button>
                    </div>
                </div>

                <div id="profilesContainer" class="profiles-grid">
                    <!-- Profiles will be loaded here -->
                </div>
            </section>
        </div>
    </main>

    <script src="config.js"></script>
    <script src="utils.js"></script>
    <script src="script.js"></script>

    <!-- Firebase and Firestore integration -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
      import { getFirestore, collection, setDoc, doc, getDocs } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyA_24ou9Dd6EJJzPFpLSS-S82tNwk_RXcI",
        authDomain: "uniroomie-faaf3.firebaseapp.com",
        projectId: "uniroomie-faaf3",
        storageBucket: "uniroomie-faaf3.firebasestorage.app",
        messagingSenderId: "52368155973",
        appId: "1:52368155973:web:b72b08365ff8c08fa6ca2c",
        measurementId: "G-05S9C2Y7K2"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      // Upload all profiles to Firestore (run ONCE, then comment out)
      window.uploadAllProfiles = async function() {
        for (const profile of window.roommateProfiles) {
          await setDoc(doc(db, "profiles", String(profile.id)), profile);
          console.log(`Uploaded profile: ${profile.name}`);
        }
        alert("All profiles uploaded to Firestore!");
      };
      // Uncomment the next line and open the browser console to run it ONCE:
      uploadAllProfiles();

      // Load all profiles from Firestore and replace roommateProfiles
      window.loadProfilesFromFirestore = async function() {
        const querySnapshot = await getDocs(collection(db, "profiles"));
        window.roommateProfiles = [];
        querySnapshot.forEach((doc) => {
          window.roommateProfiles.push(doc.data());
        });
        if (window.applyFilters) window.applyFilters();
      };
      // Call this on page load to use Firestore data:
      loadProfilesFromFirestore();
    </script>
</body>

</html>